/*
* Copyright (c) 2019, Intel Corporation
* All rights reserved.
*
* Redistribution and use in source and binary forms, with or without
* modification, are permitted provided that the following conditions are met:
*     * Redistributions of source code must retain the above copyright
*       notice, this list of conditions and the following disclaimer.
*     * Redistributions in binary form must reproduce the above copyright
*       notice, this list of conditions and the following disclaimer in the
*       documentation and/or other materials provided with the distribution.
*     * Neither the name of the Intel Corporation nor the
*       names of its contributors may be used to endorse or promote products
*       derived from this software without specific prior written permission.
*
* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
* ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
* WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
* DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> BE LIABLE FOR ANY
* DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
* (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
* LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
* ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
* (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
* SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/


#pragma once
#include "Teisko/Algorithm/Interpolate.hpp"
#include <numeric>
#include <vector>

namespace Teisko
{
    struct macbeth
    {
        static const int patch_count = 24;
        static const uint16_t minimum_wl = 380;
        static const uint16_t maximum_wl = 780;

        static std::vector<float> get_patch_reflectance(int index)
        {
            // TODO: Reflectance prior to Nov2014, should be after Nov2014
            std::vector<std::vector<float>> reflectances = std::vector<std::vector<float>>
            {
                { 0.0480f, 0.0510f, 0.0550f, 0.0600f, 0.0650f, 0.0680f, 0.0680f, 0.0670f, 0.0640f, 0.0620f, 0.0590f, 0.0570f, 0.0550f, 0.0540f, 0.0530f, 0.0530f, 0.0520f, 0.0520f, 0.0520f, 0.0530f, 0.0540f, 0.0550f, 0.0570f, 0.0590f, 0.0610f, 0.0620f, 0.0650f, 0.0670f, 0.0700f, 0.0720f, 0.0740f, 0.0750f, 0.0760f, 0.0780f, 0.0790f, 0.0820f, 0.0870f, 0.0920f, 0.1000f, 0.1070f, 0.1150f, 0.1220f, 0.1290f, 0.1340f, 0.1380f, 0.1420f, 0.1460f, 0.1500f, 0.1540f, 0.1580f, 0.1630f, 0.1670f, 0.1730f, 0.1800f, 0.1880f, 0.1960f, 0.2040f, 0.2130f, 0.2220f, 0.2310f, 0.2420f, 0.2510f, 0.2610f, 0.2710f, 0.2820f, 0.2940f, 0.3050f, 0.3180f, 0.3340f, 0.3540f, 0.3720f, 0.3920f, 0.4090f, 0.4200f, 0.4360f, 0.4500f, 0.4620f, 0.4650f, 0.4480f, 0.4320f, 0.4210f },
                { 0.1030f, 0.1200f, 0.1410f, 0.1630f, 0.1820f, 0.1920f, 0.1970f, 0.1990f, 0.2010f, 0.2030f, 0.2050f, 0.2080f, 0.2120f, 0.2170f, 0.2240f, 0.2310f, 0.2400f, 0.2510f, 0.2620f, 0.2730f, 0.2820f, 0.2890f, 0.2930f, 0.2960f, 0.3010f, 0.3100f, 0.3210f, 0.3260f, 0.3220f, 0.3100f, 0.2980f, 0.2910f, 0.2920f, 0.2970f, 0.3000f, 0.2980f, 0.2950f, 0.2950f, 0.3050f, 0.3260f, 0.3580f, 0.3970f, 0.4350f, 0.4680f, 0.4940f, 0.5140f, 0.5300f, 0.5410f, 0.5500f, 0.5570f, 0.5640f, 0.5690f, 0.5740f, 0.5820f, 0.5900f, 0.5970f, 0.6050f, 0.6140f, 0.6240f, 0.6370f, 0.6520f, 0.6680f, 0.6820f, 0.6970f, 0.7130f, 0.7280f, 0.7450f, 0.7530f, 0.7620f, 0.7740f, 0.7830f, 0.7880f, 0.7910f, 0.7870f, 0.7890f, 0.7940f, 0.8010f, 0.7990f, 0.7710f, 0.7470f, 0.7340f },
                { 0.1130f, 0.1380f, 0.1740f, 0.2190f, 0.2660f, 0.3000f, 0.3200f, 0.3300f, 0.3360f, 0.3370f, 0.3370f, 0.3370f, 0.3350f, 0.3340f, 0.3310f, 0.3270f, 0.3220f, 0.3160f, 0.3100f, 0.3020f, 0.2930f, 0.2850f, 0.2760f, 0.2680f, 0.2600f, 0.2510f, 0.2430f, 0.2340f, 0.2250f, 0.2150f, 0.2080f, 0.2030f, 0.1980f, 0.1950f, 0.1910f, 0.1880f, 0.1830f, 0.1770f, 0.1720f, 0.1670f, 0.1630f, 0.1600f, 0.1570f, 0.1530f, 0.1500f, 0.1470f, 0.1440f, 0.1410f, 0.1370f, 0.1330f, 0.1300f, 0.1260f, 0.1230f, 0.1200f, 0.1180f, 0.1150f, 0.1120f, 0.1100f, 0.1080f, 0.1060f, 0.1050f, 0.1040f, 0.1040f, 0.1030f, 0.1030f, 0.1020f, 0.1020f, 0.1020f, 0.1020f, 0.1020f, 0.1020f, 0.1040f, 0.1040f, 0.1040f, 0.1040f, 0.1060f, 0.1060f, 0.1070f, 0.1100f, 0.1150f, 0.1200f },
                { 0.0480f, 0.0490f, 0.0490f, 0.0490f, 0.0500f, 0.0490f, 0.0490f, 0.0500f, 0.0500f, 0.0510f, 0.0520f, 0.0530f, 0.0540f, 0.0560f, 0.0580f, 0.0600f, 0.0610f, 0.0630f, 0.0640f, 0.0650f, 0.0670f, 0.0680f, 0.0700f, 0.0720f, 0.0780f, 0.0880f, 0.1060f, 0.1300f, 0.1550f, 0.1730f, 0.1810f, 0.1820f, 0.1770f, 0.1680f, 0.1570f, 0.1470f, 0.1370f, 0.1290f, 0.1260f, 0.1250f, 0.1220f, 0.1190f, 0.1150f, 0.1090f, 0.1040f, 0.1000f, 0.0980f, 0.0970f, 0.0980f, 0.1000f, 0.1000f, 0.0990f, 0.0970f, 0.0960f, 0.0950f, 0.0950f, 0.0950f, 0.0970f, 0.1010f, 0.1100f, 0.1250f, 0.1470f, 0.1740f, 0.2100f, 0.2470f, 0.2830f, 0.3110f, 0.3290f, 0.3430f, 0.3530f, 0.3580f, 0.3620f, 0.3640f, 0.3600f, 0.3620f, 0.3640f, 0.3680f, 0.3680f, 0.3550f, 0.3460f, 0.3410f },
                { 0.1230f, 0.1520f, 0.1970f, 0.2580f, 0.3280f, 0.3850f, 0.4180f, 0.4370f, 0.4460f, 0.4480f, 0.4480f, 0.4470f, 0.4440f, 0.4400f, 0.4340f, 0.4280f, 0.4210f, 0.4130f, 0.4050f, 0.3940f, 0.3810f, 0.3720f, 0.3620f, 0.3520f, 0.3420f, 0.3300f, 0.3140f, 0.2940f, 0.2710f, 0.2490f, 0.2310f, 0.2190f, 0.2110f, 0.2090f, 0.2090f, 0.2070f, 0.2010f, 0.1960f, 0.1960f, 0.1990f, 0.2060f, 0.2150f, 0.2230f, 0.2290f, 0.2350f, 0.2410f, 0.2450f, 0.2450f, 0.2430f, 0.2430f, 0.2470f, 0.2540f, 0.2690f, 0.2910f, 0.3180f, 0.3510f, 0.3840f, 0.4170f, 0.4460f, 0.4700f, 0.4900f, 0.5040f, 0.5110f, 0.5170f, 0.5200f, 0.5220f, 0.5230f, 0.5220f, 0.5210f, 0.5210f, 0.5220f, 0.5210f, 0.5210f, 0.5160f, 0.5140f, 0.5140f, 0.5170f, 0.5150f, 0.5000f, 0.4910f, 0.4870f },
                { 0.1100f, 0.1330f, 0.1670f, 0.2080f, 0.2520f, 0.2840f, 0.3030f, 0.3140f, 0.3220f, 0.3290f, 0.3360f, 0.3440f, 0.3530f, 0.3630f, 0.3750f, 0.3900f, 0.4080f, 0.4330f, 0.4600f, 0.4920f, 0.5230f, 0.5480f, 0.5660f, 0.5770f, 0.5820f, 0.5830f, 0.5800f, 0.5760f, 0.5690f, 0.5600f, 0.5490f, 0.5350f, 0.5190f, 0.5010f, 0.4800f, 0.4580f, 0.4360f, 0.4140f, 0.3920f, 0.3690f, 0.3460f, 0.3240f, 0.3020f, 0.2790f, 0.2600f, 0.2450f, 0.2340f, 0.2260f, 0.2210f, 0.2170f, 0.2150f, 0.2120f, 0.2100f, 0.2090f, 0.2080f, 0.2090f, 0.2110f, 0.2150f, 0.2200f, 0.2270f, 0.2330f, 0.2390f, 0.2440f, 0.2490f, 0.2520f, 0.2520f, 0.2500f, 0.2480f, 0.2440f, 0.2450f, 0.2450f, 0.2510f, 0.2600f, 0.2690f, 0.2780f, 0.2880f, 0.2970f, 0.3010f, 0.2970f, 0.2960f, 0.2960f },
                { 0.0530f, 0.0540f, 0.0540f, 0.0540f, 0.0540f, 0.0540f, 0.0530f, 0.0530f, 0.0520f, 0.0520f, 0.0520f, 0.0520f, 0.0520f, 0.0520f, 0.0520f, 0.0520f, 0.0520f, 0.0520f, 0.0530f, 0.0540f, 0.0550f, 0.0560f, 0.0570f, 0.0590f, 0.0610f, 0.0640f, 0.0680f, 0.0760f, 0.0860f, 0.1010f, 0.1200f, 0.1430f, 0.1700f, 0.1980f, 0.2280f, 0.2600f, 0.2970f, 0.3380f, 0.3800f, 0.4180f, 0.4520f, 0.4810f, 0.5030f, 0.5200f, 0.5320f, 0.5430f, 0.5520f, 0.5600f, 0.5660f, 0.5720f, 0.5780f, 0.5830f, 0.5870f, 0.5930f, 0.5990f, 0.6020f, 0.6040f, 0.6060f, 0.6080f, 0.6110f, 0.6150f, 0.6190f, 0.6220f, 0.6250f, 0.6280f, 0.6300f, 0.6330f, 0.6330f, 0.6330f, 0.6360f, 0.6370f, 0.6390f, 0.6380f, 0.6330f, 0.6330f, 0.6360f, 0.6410f, 0.6390f, 0.6160f, 0.5980f, 0.5820f },
                { 0.0990f, 0.1200f, 0.1500f, 0.1890f, 0.2310f, 0.2680f, 0.2930f, 0.3110f, 0.3240f, 0.3350f, 0.3480f, 0.3610f, 0.3730f, 0.3830f, 0.3870f, 0.3830f, 0.3740f, 0.3610f, 0.3450f, 0.3250f, 0.3010f, 0.2750f, 0.2470f, 0.2230f, 0.2020f, 0.1840f, 0.1670f, 0.1520f, 0.1370f, 0.1250f, 0.1160f, 0.1100f, 0.1060f, 0.1030f, 0.0990f, 0.0940f, 0.0900f, 0.0860f, 0.0830f, 0.0830f, 0.0830f, 0.0850f, 0.0860f, 0.0870f, 0.0870f, 0.0860f, 0.0850f, 0.0840f, 0.0840f, 0.0850f, 0.0880f, 0.0920f, 0.0980f, 0.1050f, 0.1110f, 0.1180f, 0.1230f, 0.1260f, 0.1260f, 0.1240f, 0.1200f, 0.1170f, 0.1150f, 0.1150f, 0.1160f, 0.1180f, 0.1200f, 0.1240f, 0.1280f, 0.1330f, 0.1390f, 0.1490f, 0.1620f, 0.1780f, 0.1970f, 0.2190f, 0.2420f, 0.2590f, 0.2750f, 0.2940f, 0.3160f },
                { 0.0960f, 0.1080f, 0.1230f, 0.1350f, 0.1440f, 0.1450f, 0.1440f, 0.1410f, 0.1380f, 0.1340f, 0.1320f, 0.1320f, 0.1310f, 0.1310f, 0.1290f, 0.1280f, 0.1260f, 0.1260f, 0.1250f, 0.1230f, 0.1190f, 0.1140f, 0.1090f, 0.1050f, 0.1030f, 0.1020f, 0.1000f, 0.0970f, 0.0940f, 0.0910f, 0.0890f, 0.0900f, 0.0920f, 0.0960f, 0.1020f, 0.1060f, 0.1080f, 0.1090f, 0.1120f, 0.1260f, 0.1570f, 0.2080f, 0.2740f, 0.3460f, 0.4150f, 0.4730f, 0.5170f, 0.5470f, 0.5670f, 0.5820f, 0.5910f, 0.5970f, 0.6010f, 0.6040f, 0.6070f, 0.6080f, 0.6070f, 0.6060f, 0.6050f, 0.6050f, 0.6050f, 0.6040f, 0.6050f, 0.6060f, 0.6060f, 0.6040f, 0.6020f, 0.6010f, 0.5990f, 0.5980f, 0.5960f, 0.5950f, 0.5930f, 0.5870f, 0.5840f, 0.5840f, 0.5860f, 0.5840f, 0.5660f, 0.5510f, 0.5400f },
                { 0.1010f, 0.1150f, 0.1350f, 0.1570f, 0.1770f, 0.1910f, 0.1990f, 0.2030f, 0.2060f, 0.1980f, 0.1900f, 0.1790f, 0.1680f, 0.1560f, 0.1440f, 0.1320f, 0.1200f, 0.1100f, 0.1010f, 0.0930f, 0.0860f, 0.0800f, 0.0750f, 0.0700f, 0.0670f, 0.0630f, 0.0610f, 0.0590f, 0.0580f, 0.0560f, 0.0540f, 0.0530f, 0.0520f, 0.0520f, 0.0530f, 0.0540f, 0.0550f, 0.0550f, 0.0540f, 0.0530f, 0.0520f, 0.0520f, 0.0530f, 0.0550f, 0.0590f, 0.0650f, 0.0740f, 0.0860f, 0.0990f, 0.1130f, 0.1260f, 0.1380f, 0.1490f, 0.1610f, 0.1720f, 0.1820f, 0.1930f, 0.2050f, 0.2170f, 0.2320f, 0.2480f, 0.2660f, 0.2820f, 0.3010f, 0.3190f, 0.3380f, 0.3550f, 0.3710f, 0.3880f, 0.4060f, 0.4220f, 0.4360f, 0.4510f, 0.4600f, 0.4710f, 0.4810f, 0.4920f, 0.4950f, 0.4820f, 0.4710f, 0.4670f },
                { 0.0560f, 0.0580f, 0.0590f, 0.0590f, 0.0600f, 0.0610f, 0.0610f, 0.0610f, 0.0620f, 0.0630f, 0.0640f, 0.0660f, 0.0680f, 0.0710f, 0.0750f, 0.0790f, 0.0850f, 0.0930f, 0.1040f, 0.1180f, 0.1350f, 0.1570f, 0.1850f, 0.2210f, 0.2690f, 0.3260f, 0.3840f, 0.4400f, 0.4840f, 0.5160f, 0.5340f, 0.5420f, 0.5450f, 0.5410f, 0.5330f, 0.5240f, 0.5130f, 0.5010f, 0.4870f, 0.4720f, 0.4540f, 0.4360f, 0.4160f, 0.3940f, 0.3740f, 0.3580f, 0.3460f, 0.3370f, 0.3310f, 0.3280f, 0.3250f, 0.3220f, 0.3200f, 0.3190f, 0.3190f, 0.3200f, 0.3240f, 0.3300f, 0.3370f, 0.3450f, 0.3540f, 0.3620f, 0.3680f, 0.3750f, 0.3790f, 0.3810f, 0.3790f, 0.3760f, 0.3730f, 0.3720f, 0.3750f, 0.3820f, 0.3920f, 0.4010f, 0.4120f, 0.4220f, 0.4330f, 0.4360f, 0.4260f, 0.4130f, 0.4040f },
                { 0.0600f, 0.0610f, 0.0630f, 0.0640f, 0.0650f, 0.0650f, 0.0640f, 0.0640f, 0.0640f, 0.0640f, 0.0640f, 0.0650f, 0.0650f, 0.0660f, 0.0670f, 0.0680f, 0.0690f, 0.0730f, 0.0770f, 0.0840f, 0.0920f, 0.1000f, 0.1070f, 0.1150f, 0.1230f, 0.1330f, 0.1460f, 0.1660f, 0.1930f, 0.2290f, 0.2730f, 0.3230f, 0.3740f, 0.4180f, 0.4560f, 0.4870f, 0.5120f, 0.5340f, 0.5540f, 0.5700f, 0.5840f, 0.5980f, 0.6090f, 0.6170f, 0.6240f, 0.6300f, 0.6350f, 0.6400f, 0.6450f, 0.6500f, 0.6540f, 0.6580f, 0.6620f, 0.6670f, 0.6720f, 0.6750f, 0.6760f, 0.6770f, 0.6780f, 0.6810f, 0.6850f, 0.6880f, 0.6900f, 0.6930f, 0.6960f, 0.6980f, 0.6980f, 0.6980f, 0.6980f, 0.7000f, 0.7010f, 0.7010f, 0.7010f, 0.6950f, 0.6940f, 0.6960f, 0.7000f, 0.6980f, 0.6730f, 0.6530f, 0.6390f },
                { 0.0690f, 0.0810f, 0.0960f, 0.1140f, 0.1360f, 0.1560f, 0.1750f, 0.1930f, 0.2080f, 0.2240f, 0.2440f, 0.2650f, 0.2900f, 0.3160f, 0.3350f, 0.3420f, 0.3380f, 0.3240f, 0.3020f, 0.2730f, 0.2390f, 0.2050f, 0.1720f, 0.1440f, 0.1200f, 0.1010f, 0.0860f, 0.0740f, 0.0660f, 0.0590f, 0.0540f, 0.0510f, 0.0480f, 0.0460f, 0.0450f, 0.0440f, 0.0430f, 0.0420f, 0.0410f, 0.0410f, 0.0400f, 0.0400f, 0.0400f, 0.0400f, 0.0390f, 0.0390f, 0.0400f, 0.0400f, 0.0400f, 0.0400f, 0.0410f, 0.0410f, 0.0420f, 0.0420f, 0.0420f, 0.0430f, 0.0430f, 0.0430f, 0.0440f, 0.0440f, 0.0440f, 0.0440f, 0.0450f, 0.0460f, 0.0480f, 0.0500f, 0.0510f, 0.0530f, 0.0560f, 0.0600f, 0.0640f, 0.0700f, 0.0790f, 0.0910f, 0.1040f, 0.1200f, 0.1380f, 0.1540f, 0.1680f, 0.1860f, 0.2040f },
                { 0.0550f, 0.0560f, 0.0570f, 0.0580f, 0.0580f, 0.0580f, 0.0590f, 0.0590f, 0.0590f, 0.0600f, 0.0620f, 0.0630f, 0.0650f, 0.0670f, 0.0700f, 0.0740f, 0.0780f, 0.0840f, 0.0910f, 0.1010f, 0.1130f, 0.1250f, 0.1400f, 0.1570f, 0.1800f, 0.2080f, 0.2440f, 0.2860f, 0.3240f, 0.3510f, 0.3630f, 0.3630f, 0.3550f, 0.3420f, 0.3230f, 0.3030f, 0.2810f, 0.2600f, 0.2380f, 0.2170f, 0.1960f, 0.1770f, 0.1580f, 0.1400f, 0.1240f, 0.1110f, 0.1010f, 0.0940f, 0.0890f, 0.0860f, 0.0840f, 0.0820f, 0.0800f, 0.0780f, 0.0770f, 0.0760f, 0.0750f, 0.0750f, 0.0750f, 0.0770f, 0.0780f, 0.0800f, 0.0820f, 0.0850f, 0.0880f, 0.0890f, 0.0890f, 0.0900f, 0.0900f, 0.0900f, 0.0890f, 0.0920f, 0.0940f, 0.0970f, 0.1020f, 0.1060f, 0.1100f, 0.1110f, 0.1120f, 0.1120f, 0.1120f },
                { 0.0520f, 0.0520f, 0.0520f, 0.0520f, 0.0510f, 0.0510f, 0.0500f, 0.0500f, 0.0490f, 0.0490f, 0.0490f, 0.0490f, 0.0490f, 0.0490f, 0.0490f, 0.0480f, 0.0480f, 0.0470f, 0.0470f, 0.0460f, 0.0450f, 0.0450f, 0.0440f, 0.0440f, 0.0440f, 0.0440f, 0.0440f, 0.0440f, 0.0440f, 0.0440f, 0.0440f, 0.0440f, 0.0450f, 0.0460f, 0.0470f, 0.0480f, 0.0500f, 0.0530f, 0.0570f, 0.0630f, 0.0720f, 0.0860f, 0.1090f, 0.1430f, 0.1920f, 0.2560f, 0.3320f, 0.4130f, 0.4860f, 0.5500f, 0.5980f, 0.6310f, 0.6540f, 0.6720f, 0.6860f, 0.6940f, 0.7000f, 0.7040f, 0.7070f, 0.7120f, 0.7180f, 0.7210f, 0.7240f, 0.7270f, 0.7290f, 0.7300f, 0.7300f, 0.7290f, 0.7270f, 0.7280f, 0.7290f, 0.7290f, 0.7270f, 0.7230f, 0.7210f, 0.7240f, 0.7280f, 0.7270f, 0.7020f, 0.6800f, 0.6640f },
                { 0.0540f, 0.0530f, 0.0540f, 0.0530f, 0.0530f, 0.0530f, 0.0530f, 0.0520f, 0.0520f, 0.0520f, 0.0530f, 0.0530f, 0.0530f, 0.0540f, 0.0550f, 0.0560f, 0.0590f, 0.0650f, 0.0750f, 0.0930f, 0.1210f, 0.1570f, 0.2020f, 0.2520f, 0.3030f, 0.3510f, 0.3940f, 0.4360f, 0.4750f, 0.5120f, 0.5440f, 0.5720f, 0.5970f, 0.6150f, 0.6300f, 0.6450f, 0.6600f, 0.6730f, 0.6860f, 0.6980f, 0.7080f, 0.7180f, 0.7260f, 0.7320f, 0.7370f, 0.7420f, 0.7460f, 0.7490f, 0.7530f, 0.7570f, 0.7610f, 0.7650f, 0.7680f, 0.7720f, 0.7770f, 0.7790f, 0.7800f, 0.7800f, 0.7810f, 0.7820f, 0.7850f, 0.7850f, 0.7870f, 0.7890f, 0.7920f, 0.7920f, 0.7930f, 0.7920f, 0.7900f, 0.7920f, 0.7920f, 0.7900f, 0.7870f, 0.7820f, 0.7780f, 0.7800f, 0.7820f, 0.7810f, 0.7520f, 0.7280f, 0.7100f },
                { 0.1180f, 0.1420f, 0.1790f, 0.2280f, 0.2830f, 0.3220f, 0.3430f, 0.3540f, 0.3590f, 0.3570f, 0.3500f, 0.3390f, 0.3270f, 0.3130f, 0.2980f, 0.2820f, 0.2670f, 0.2530f, 0.2390f, 0.2250f, 0.2090f, 0.1950f, 0.1820f, 0.1720f, 0.1630f, 0.1550f, 0.1460f, 0.1350f, 0.1240f, 0.1130f, 0.1060f, 0.1020f, 0.1020f, 0.1050f, 0.1070f, 0.1070f, 0.1060f, 0.1070f, 0.1120f, 0.1230f, 0.1410f, 0.1660f, 0.1980f, 0.2350f, 0.2790f, 0.3330f, 0.3940f, 0.4600f, 0.5220f, 0.5800f, 0.6280f, 0.6660f, 0.6960f, 0.7220f, 0.7420f, 0.7560f, 0.7660f, 0.7740f, 0.7800f, 0.7850f, 0.7910f, 0.7940f, 0.7980f, 0.8010f, 0.8040f, 0.8060f, 0.8070f, 0.8070f, 0.8070f, 0.8100f, 0.8130f, 0.8140f, 0.8130f, 0.8100f, 0.8080f, 0.8110f, 0.8140f, 0.8130f, 0.7850f, 0.7650f, 0.7520f },
                { 0.0930f, 0.1100f, 0.1340f, 0.1640f, 0.1950f, 0.2200f, 0.2380f, 0.2490f, 0.2580f, 0.2700f, 0.2810f, 0.2960f, 0.3150f, 0.3340f, 0.3520f, 0.3700f, 0.3910f, 0.4140f, 0.4340f, 0.4490f, 0.4580f, 0.4610f, 0.4570f, 0.4470f, 0.4330f, 0.4140f, 0.3920f, 0.3660f, 0.3390f, 0.3100f, 0.2820f, 0.2550f, 0.2280f, 0.2040f, 0.1800f, 0.1590f, 0.1410f, 0.1260f, 0.1140f, 0.1040f, 0.0970f, 0.0920f, 0.0880f, 0.0830f, 0.0800f, 0.0770f, 0.0750f, 0.0740f, 0.0730f, 0.0730f, 0.0730f, 0.0730f, 0.0730f, 0.0730f, 0.0740f, 0.0750f, 0.0760f, 0.0760f, 0.0770f, 0.0760f, 0.0750f, 0.0740f, 0.0740f, 0.0730f, 0.0720f, 0.0720f, 0.0710f, 0.0730f, 0.0750f, 0.0780f, 0.0820f, 0.0900f, 0.1000f, 0.1160f, 0.1330f, 0.1540f, 0.1760f, 0.1910f, 0.2000f, 0.2080f, 0.2140f },
                { 0.1530f, 0.1890f, 0.2450f, 0.3190f, 0.4090f, 0.5360f, 0.6710f, 0.7720f, 0.8400f, 0.8680f, 0.8780f, 0.8820f, 0.8830f, 0.8850f, 0.8860f, 0.8860f, 0.8870f, 0.8880f, 0.8880f, 0.8880f, 0.8880f, 0.8880f, 0.8880f, 0.8880f, 0.8870f, 0.8870f, 0.8870f, 0.8870f, 0.8870f, 0.8870f, 0.8870f, 0.8870f, 0.8870f, 0.8860f, 0.8860f, 0.8870f, 0.8870f, 0.8870f, 0.8880f, 0.8880f, 0.8870f, 0.8860f, 0.8860f, 0.8860f, 0.8870f, 0.8880f, 0.8890f, 0.8900f, 0.8910f, 0.8910f, 0.8910f, 0.8910f, 0.8900f, 0.8890f, 0.8890f, 0.8890f, 0.8890f, 0.8890f, 0.8880f, 0.8880f, 0.8880f, 0.8880f, 0.8880f, 0.8880f, 0.8880f, 0.8870f, 0.8860f, 0.8860f, 0.8860f, 0.8850f, 0.8850f, 0.8850f, 0.8840f, 0.8840f, 0.8830f, 0.8820f, 0.8820f, 0.8810f, 0.8800f, 0.8800f, 0.8790f },
                { 0.1500f, 0.1840f, 0.2350f, 0.2990f, 0.3720f, 0.4590f, 0.5290f, 0.5640f, 0.5800f, 0.5840f, 0.5850f, 0.5870f, 0.5870f, 0.5880f, 0.5880f, 0.5870f, 0.5860f, 0.5850f, 0.5830f, 0.5820f, 0.5810f, 0.5800f, 0.5800f, 0.5800f, 0.5800f, 0.5800f, 0.5800f, 0.5810f, 0.5810f, 0.5820f, 0.5820f, 0.5820f, 0.5830f, 0.5830f, 0.5830f, 0.5840f, 0.5840f, 0.5850f, 0.5860f, 0.5870f, 0.5880f, 0.5880f, 0.5880f, 0.5880f, 0.5880f, 0.5870f, 0.5860f, 0.5860f, 0.5850f, 0.5840f, 0.5830f, 0.5810f, 0.5800f, 0.5790f, 0.5780f, 0.5770f, 0.5760f, 0.5750f, 0.5740f, 0.5730f, 0.5720f, 0.5710f, 0.5700f, 0.5690f, 0.5680f, 0.5670f, 0.5660f, 0.5650f, 0.5640f, 0.5620f, 0.5620f, 0.5600f, 0.5600f, 0.5580f, 0.5570f, 0.5560f, 0.5550f, 0.5540f, 0.5530f, 0.5510f, 0.5500f },
                { 0.1380f, 0.1670f, 0.2060f, 0.2490f, 0.2890f, 0.3240f, 0.3460f, 0.3540f, 0.3570f, 0.3580f, 0.3590f, 0.3600f, 0.3610f, 0.3620f, 0.3620f, 0.3610f, 0.3610f, 0.3590f, 0.3580f, 0.3580f, 0.3570f, 0.3560f, 0.3560f, 0.3560f, 0.3560f, 0.3560f, 0.3560f, 0.3560f, 0.3570f, 0.3570f, 0.3570f, 0.3580f, 0.3580f, 0.3580f, 0.3580f, 0.3580f, 0.3590f, 0.3590f, 0.3600f, 0.3610f, 0.3610f, 0.3610f, 0.3610f, 0.3610f, 0.3600f, 0.3600f, 0.3590f, 0.3580f, 0.3570f, 0.3560f, 0.3550f, 0.3540f, 0.3530f, 0.3520f, 0.3510f, 0.3500f, 0.3490f, 0.3480f, 0.3460f, 0.3460f, 0.3450f, 0.3440f, 0.3430f, 0.3420f, 0.3410f, 0.3400f, 0.3390f, 0.3380f, 0.3370f, 0.3360f, 0.3350f, 0.3340f, 0.3330f, 0.3320f, 0.3310f, 0.3300f, 0.3290f, 0.3280f, 0.3270f, 0.3260f, 0.3250f },
                { 0.1130f, 0.1310f, 0.1500f, 0.1690f, 0.1830f, 0.1930f, 0.1990f, 0.2010f, 0.2020f, 0.2030f, 0.2030f, 0.2040f, 0.2050f, 0.2050f, 0.2050f, 0.2050f, 0.2040f, 0.2040f, 0.2030f, 0.2030f, 0.2020f, 0.2020f, 0.2020f, 0.2020f, 0.2020f, 0.2020f, 0.2020f, 0.2020f, 0.2020f, 0.2020f, 0.2030f, 0.2030f, 0.2030f, 0.2030f, 0.2030f, 0.2030f, 0.2030f, 0.2030f, 0.2040f, 0.2040f, 0.2050f, 0.2050f, 0.2050f, 0.2050f, 0.2040f, 0.2040f, 0.2040f, 0.2030f, 0.2030f, 0.2020f, 0.2010f, 0.2010f, 0.2000f, 0.1990f, 0.1980f, 0.1980f, 0.1970f, 0.1970f, 0.1960f, 0.1950f, 0.1950f, 0.1940f, 0.1940f, 0.1930f, 0.1920f, 0.1920f, 0.1910f, 0.1910f, 0.1900f, 0.1890f, 0.1890f, 0.1880f, 0.1880f, 0.1870f, 0.1870f, 0.1860f, 0.1850f, 0.1850f, 0.1840f, 0.1840f, 0.1830f },
                { 0.0740f, 0.0790f, 0.0840f, 0.0880f, 0.0910f, 0.0930f, 0.0940f, 0.0940f, 0.0940f, 0.0940f, 0.0940f, 0.0950f, 0.0950f, 0.0950f, 0.0950f, 0.0940f, 0.0940f, 0.0940f, 0.0940f, 0.0930f, 0.0930f, 0.0930f, 0.0930f, 0.0920f, 0.0920f, 0.0930f, 0.0930f, 0.0930f, 0.0930f, 0.0930f, 0.0930f, 0.0930f, 0.0930f, 0.0930f, 0.0930f, 0.0920f, 0.0930f, 0.0930f, 0.0930f, 0.0930f, 0.0930f, 0.0930f, 0.0930f, 0.0920f, 0.0920f, 0.0920f, 0.0920f, 0.0910f, 0.0910f, 0.0910f, 0.0900f, 0.0900f, 0.0900f, 0.0900f, 0.0890f, 0.0890f, 0.0890f, 0.0880f, 0.0880f, 0.0880f, 0.0870f, 0.0870f, 0.0870f, 0.0870f, 0.0860f, 0.0860f, 0.0860f, 0.0860f, 0.0850f, 0.0850f, 0.0850f, 0.0850f, 0.0850f, 0.0840f, 0.0840f, 0.0840f, 0.0840f, 0.0840f, 0.0830f, 0.0830f, 0.0830f },
                { 0.0320f, 0.0330f, 0.0330f, 0.0340f, 0.0350f, 0.0350f, 0.0360f, 0.0360f, 0.0360f, 0.0360f, 0.0360f, 0.0360f, 0.0350f, 0.0350f, 0.0350f, 0.0350f, 0.0350f, 0.0350f, 0.0350f, 0.0350f, 0.0340f, 0.0340f, 0.0340f, 0.0340f, 0.0340f, 0.0340f, 0.0340f, 0.0340f, 0.0340f, 0.0340f, 0.0340f, 0.0340f, 0.0340f, 0.0340f, 0.0340f, 0.0340f, 0.0330f, 0.0330f, 0.0330f, 0.0330f, 0.0330f, 0.0330f, 0.0330f, 0.0330f, 0.0330f, 0.0330f, 0.0330f, 0.0330f, 0.0330f, 0.0330f, 0.0330f, 0.0330f, 0.0330f, 0.0330f, 0.0330f, 0.0330f, 0.0330f, 0.0330f, 0.0330f, 0.0330f, 0.0330f, 0.0330f, 0.0320f, 0.0320f, 0.0320f, 0.0320f, 0.0320f, 0.0320f, 0.0320f, 0.0320f, 0.0320f, 0.0320f, 0.0320f, 0.0320f, 0.0320f, 0.0320f, 0.0320f, 0.0320f, 0.0320f, 0.0320f, 0.0320f },
            };

            std::vector<float> wavelength{ 380, 385, 390, 395, 400, 405, 410, 415, 420, 425, 430, 435, 440, 445, 450, 455, 460, 465, 470, 475, 480, 485, 490, 495, 500, 505, 510, 515, 520, 525, 530, 535, 540, 545, 550, 555, 560, 565, 570, 575, 580, 585, 590, 595, 600, 605, 610, 615, 620, 625, 630, 635, 640, 645, 650, 655, 660, 665, 670, 675, 680, 685, 690, 695, 700, 705, 710, 715, 720, 725, 730, 735, 740, 745, 750, 755, 760, 765, 770, 775, 780 };

            std::vector<float> wl(maximum_wl - minimum_wl + 1);
            std::iota(wl.begin(), wl.end(), minimum_wl);

            return interp1d(wavelength, reflectances[index], wl);
        }
    };
}
